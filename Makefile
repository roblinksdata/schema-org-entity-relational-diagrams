WORKING_DIR			= $(shell pwd)
CLASSES				:=	"LakeBodyOfWater" "Manuscript" "SubwayStation" "FloorPlan" "PaymentMethod" "Physician" "APIReference" "MedicalImagingTechnique" "MemberProgramTier" "FoodService" "BlogPosting" "Photograph" "ReadAction" "WholesaleStore" "Action" "Vessel" "VirtualLocation" "CollegeOrUniversity" "AutoPartsStore" "SheetMusic" "DrugPregnancyCategory" "AgreeAction" "Series" "GameServerStatus" "MemberProgram" "SomeProducts" "ContactPoint" "BankAccount" "WebPage" "PostalCodeRangeSpecification" "FindAction" "CatholicChurch" "AutoDealer" "OccupationalExperienceRequirements" "HowToStep" "PropertyValue" "BloodTest" "OrganizationRole" "PayAction" "TouristTrip" "PropertyValueSpecification" "WPSideBar" "CableOrSatelliteService" "DoseSchedule" "Message" "Chapter" "Locksmith" "TaxiStand" "BusOrCoach" "PrependAction" "GovernmentPermit" "InvestmentOrDeposit" "Game" "ReplaceAction" "CompleteDataFeed" "EventStatusType" "HowToItem" "ShareAction" "BankOrCreditUnion" "OceanBodyOfWater" "MenuSection" "EducationalOccupationalProgram" "VideoGame" "ImageGallery" "WatchAction" "Protein" "DonateAction" "BookmarkAction" "HealthInsurancePlan" "Attorney" "AudioObjectSnapshot" "FAQPage" "DataDownload" "MovieSeries" "MediaObject" "ChemicalSubstance" "VideoGallery" "MusicGroup" "ReceiveAction" "BoardingPolicyType" "SeekToAction" "EmployerReview" "Language" "LendAction" "Hostel" "MedicalConditionStage" "BuyAction" "MusicRelease" "Flight" "MusicRecording" "WPFooter" "FinancialService" "AmusementPark" "LegalService" "StructuredValue" "ShortStory" "Book" "FMRadioChannel" "MedicalEnumeration" "Sculpture" "AdvertiserContentArticle" "HealthPlanFormulary" "EmploymentAgency" "OfferItemCondition" "MaximumDoseSchedule" "QualitativeValue" "Consortium" "DepartAction" "PaymentStatusType" "AppendAction" "MoveAction" "OpeningHoursSpecification" "SpeakableSpecification" "PhysicalActivityCategory" "SteeringPositionValue" "EducationalAudience" "WPHeader" "ProfessionalService" "SportsEvent" "Legislation" "Restaurant" "EventAttendanceModeEnumeration" "AnatomicalStructure" "School" "PerformingArtsTheater" "CheckOutAction" "ReturnMethodEnumeration" "ItemPage" "Answer" "AggregateOffer" "QuoteAction" "BusinessFunction" "DisagreeAction" "TravelAction" "EducationalOrganization" "MonetaryGrant" "EmailMessage" "InteractAction" "TouristDestination" "VideoObjectSnapshot" "ArtGallery" "RadioBroadcastService" "WorkBasedProgram" "MedicalOrganization" "Zoo" "MusicEvent" "AggregateRating" "MedicalProcedure" "Drug" "ActivateAction" "FastFoodRestaurant" "MedicalCause" "MedicalGuidelineContraindication" "ScreeningEvent" "RealEstateListing" "DayOfWeek" "Episode" "HowToDirection" "CancelAction" "GamePlayMode" "TierBenefitEnumeration" "IgnoreAction" "DeliveryChargeSpecification" "BefriendAction" "GeoCoordinates" "DeleteAction" "RsvpResponseType" "NonprofitType" "Quotation" "NailSalon" "TattooParlor" "Atlas" "Landform" "PeopleAudience" "Observation" "EngineSpecification" "RVPark" "BedType" "VisualArtwork" "CarUsageType" "ContactPointOption" "AutomotiveBusiness" "Guide" "PawnShop" "MarryAction" "Syllabus" "OnDemandEvent" "Property" "Church" "TechArticle" "CreateAction" "ShippingRateSettings" "Barcode" "ReviewAction" "BusStation" "ReserveAction" "ComputerStore" "TVSeason" "Plumber" "Hotel" "ArchiveComponent" "DeliveryEvent" "GiveAction" "RadiationTherapy" "DDxElement" "GovernmentBenefitsType" "PresentationDigitalDocument" "LodgingReservation" "CurrencyConversionService" "Event" "LocalBusiness" "MediaReviewItem" "SurgicalProcedure" "DigitalDocument" "DislikeAction" "VitalSign" "InsuranceAgency" "Continent" "BookFormatType" "BroadcastFrequencySpecification" "MedicalTrialDesign" "DeactivateAction" "Mountain" "CorrectionComment" "GolfCourse" "AcceptAction" "MusicPlaylist" "Trip" "ReactAction" "ComputerLanguage" "RecommendedDoseSchedule" "RadioSeason" "Claim" "GameServer" "OrganizeAction" "Rating" "Audiobook" "TrainReservation" "StatusEnumeration" "EnergyConsumptionDetails" "ProfilePage" "CafeOrCoffeeShop" "Car" "Intangible" "DataFeedItem" "CriticReview" "TheaterEvent" "BedAndBreakfast" "SocialMediaPosting" "DrugStrength" "Place" "StatisticalPopulation" "ComicStory" "SpecialAnnouncement" "Canal" "HealthPlanCostSharingSpecification" "PriceTypeEnumeration" "Report" "ComedyEvent" "ResumeAction" "Recipe" "ReturnAction" "BowlingAlley" "PsychologicalTreatment" "InteractionCounter" "Schedule" "EventSeries" "PerformAction" "ProductCollection" "HyperToc" "MediaGallery" "InfectiousAgentClass" "HealthAspectEnumeration" "USNonprofitType" "TradeAction" "ProductGroup" "Bridge" "EventReservation" "RadioStation" "MedicalIndication" "Hospital" "MedicalSign" "EmployerAggregateRating" "DanceEvent" "SearchResultsPage" "Taxi" "MedicalClinic" "AssignAction" "PodcastEpisode" "ProductModel" "MedicalGuidelineRecommendation" "ReplyAction" "UserPlays" "OfferCatalog" "Volcano" "HowToTool" "Movie" "UserBlocks" "MedicalAudience" "Specialty" "TherapeuticProcedure" "Statement" "LegalValueLevel" "FilmAction" "WebContent" "GovernmentOrganization" "HomeGoodsStore" "TheaterGroup" "Class" "Nerve" "HomeAndConstructionBusiness" "FoodEstablishment" "Collection" "PoliticalParty" "LegalForceStatus" "NewsArticle" "TelevisionChannel" "TextDigitalDocument" "FurnitureStore" "RentAction" "DataFeed" "LearningResource" "Conversation" "Motel" "QuantitativeValueDistribution" "MonetaryAmount" "Thesis" "HighSchool" "TaxiService" "AllocateAction" "MediaEnumeration" "LymphaticVessel" "ExercisePlan" "BodyMeasurementTypeEnumeration" "Ligament" "PerformanceRole" "MediaReview" "ResearchOrganization" "SportsOrganization" "ExerciseGym" "TaxiReservation" "EntertainmentBusiness" "EatAction" "AnalysisNewsArticle" "Winery" "Service" "Mass" "BeautySalon" "SeaBodyOfWater" "CollectionPage" "SportsClub" "SellAction" "SocialEvent" "Room" "AdultEntertainment" "ChildCare" "DanceGroup" "ReturnFeesEnumeration" "DryCleaningOrLaundry" "MedicalTestPanel" "MedicalGuideline" "DrugPrescriptionStatus" "BusinessEntityType" "ServiceChannel" "Preschool" "HowToSection" "Airline" "AskAction" "MedicalRiskFactor" "MotorizedBicycle" "OrderStatus" "EndorseAction" "JoinAction" "Brand" "BioChemEntity" "GasStation" "UserReview" "ShoppingCenter" "VideoGameSeries" "Question" "SearchAction" "SaleEvent" "PathologyTest" "Poster" "LifestyleModification" "MedicalTest" "HealthAndBeautyBusiness" "MusicStore" "EnergyStarEnergyEfficiencyEnumeration" "UpdateAction" "MedicalObservationalStudy" "CreativeWorkSeries" "BusTrip" "DownloadAction" "Menu" "Seat" "QAPage" "PlanAction" "MotorcycleDealer" "Periodical" "ListenAction" "SoftwareSourceCode" "WebPageElement" "DrawAction" "SportingGoodsStore" "Optician" "PlaceOfWorship" "Quiz" "Brewery" "CommentAction" "InternetCafe" "AuthorizeAction" "MedicalRiskEstimator" "ConvenienceStore" "DrugLegalStatus" "DiagnosticProcedure" "Dentist" "Grant" "RoofingContractor" "TransferAction" "SatiricalArticle" "BoatTerminal" "AboutPage" "ScholarlyArticle" "ConfirmAction" "PaymentChargeSpecification" "GroceryStore" "DriveWheelConfigurationValue" "RecyclingCenter" "Order" "MedicalSpecialty" "MusicComposition" "ResearchProject" "Role" "PublicationVolume" "AnatomicalSystem" "Aquarium" "DefinedTerm" "Florist" "BikeStore" "PriceComponentTypeEnumeration" "FoodEvent" "LocationFeatureSpecification" "AskPublicNewsArticle" "Course" "DrinkAction" "ImageObjectSnapshot" "AssessAction" "MobileApplication" "ListItem" "CivicStructure" "Reservoir" "TVClip" "EnergyEfficiencyEnumeration" "LoseAction" "Dataset" "TreatmentIndication" "ActionStatusType" "PublicSwimmingPool" "MerchantReturnEnumeration" "MedicalTherapy" "MedicalDevice" "MedicalEvidenceLevel" "VacationRental" "Drawing" "ExerciseAction" "PodcastSeries" "TouristAttraction" "UserInteraction" "Taxon" "ContactPage" "BedDetails" "UserCheckins" "Audience" "InvestmentFund" "WearAction" "BrokerageAccount" "GatedResidenceCommunity" "LiveBlogPosting" "MedicalWebPage" "TextObject" "PodcastSeason" "AdministrativeArea" "TrackAction" "TravelAgency" "VeterinaryCare" "TrainStation" "PhysicalExam" "SuspendAction" "MediaSubscription" "UnitPriceSpecification" "Gene" "OfferShippingDetails" "ChildrensEvent" "Cemetery" "Apartment" "MedicalRiskCalculator" "InfectiousDisease" "CheckoutPage" "BroadcastEvent" "HinduTemple" "ElementarySchool" "TipAction" "CampingPitch" "Airport" "Substance" "HousePainter" "FundingAgency" "EndorsementRating" "MedicalSignOrSymptom" "DataCatalog" "AutoBodyShop" "LibrarySystem" "GeoCircle" "VisualArtsEvent" "ReportageNewsArticle" "Synagogue" "MovingCompany" "ComicSeries" "DrugCostCategory" "PoliceStation" "DeliveryMethod" "InviteAction" "PaymentCard" "AutoRental" "MerchantReturnPolicy" "JewelryStore" "Beach" "ImagingTest" "City" "ReportedDoseSchedule" "WarrantyScope" "ComicIssue" "ElectronicsStore" "MusicVenue" "Casino" "ItemAvailability" "BroadcastService" "SolveMathAction" "NGO" "DrugCost" "MedicalCode" "MotorcycleRepair" "UnRegisterAction" "Offer" "Library" "ShoeStore" "Pharmacy" "WebApplication" "VideoObject" "SiteNavigationElement" "Waterfall" "MedicalEntity" "ComedyClub" "HealthTopicContent" "CheckInAction" "JobPosting" "DietarySupplement" "PostalAddress" "MusicAlbumReleaseType" "FundingScheme" "Patient" "GeneralContractor" "Person" "LoanOrCredit" "RadioClip" "Organization" "EducationalOccupationalCredential" "Bone" "RiverBodyOfWater" "ApartmentComplex" "PublicationIssue" "ParentAudience" "FireStation" "LikeAction" "CreativeWorkSeason" "Park" "AMRadioChannel" "TypeAndQuantityNode" "EUEnergyEfficiencyEnumeration" "OfferForPurchase" "CommunicateAction" "ActionAccessSpecification" "BarOrPub" "DataType" "PublicationEvent" "QuantitativeValue" "InstallAction" "LegislativeBuilding" "WPAdBlock" "MathSolver" "WriteAction" "Play" "BroadcastChannel" "HealthPlanNetwork" "Festival" "AchieveAction" "Motorcycle" "LinkRole" "GovernmentOffice" "SpreadsheetDigitalDocument" "RefundTypeEnumeration" "ParcelDelivery" "SkiResort" "AnimalShelter" "SizeGroupEnumeration" "Reservation" "CovidTestingFacility" "MedicalTrial" "UserComments" "DefinedRegion" "OrderItem" "DigitalDocumentPermission" "DefinedTermSet" "PhotographAction" "MedicalStudy" "LodgingBusiness" "PhysicalActivity" "RadioSeries" "BoatTrip" "Resort" "SportsTeam" "PhysiciansOffice" "OccupationalTherapy" "DigitalDocumentPermissionType" "TennisComplex" "MedicalScholarlyArticle" "NLNonprofitType" "Embassy" "AmpStory" "RepaymentSpecification" "RadioChannel" "BusReservation" "MedicalObservationalStudyDesign" "UKNonprofitType" "Review" "HVACBusiness" "Notary" "LiquorStore" "Artery" "ArriveAction" "DaySpa" "Table" "TieAction" "WarrantyPromise" "RegisterAction" "PriceSpecification" "BookSeries" "HardwareStore" "Electrician" "CertificationStatusEnumeration" "OutletStore" "BusStop" "Clip" "DiscoverAction" "MedicalStudyStatus" "MobilePhoneStore" "EmergencyService" "CookAction" "UserTweets" "GeoShape" "MedicineSystem" "MovieTheater" "ProgramMembership" "IceCreamShop" "Product" "CreditCard" "WearableSizeGroupEnumeration" "GovernmentBuilding" "Corporation" "WebSite" "MedicalRiskScore" "NoteDigitalDocument" "GovernmentService" "PerformingGroup" "DiscussionForumPosting" "NightClub" "SelfStorage" "DepositAccount" "UserDownloads" "MovieRentalStore" "Vehicle" "ExhibitionEvent" "Playground" "SchoolDistrict" "HotelRoom" "PaymentMethodType" "ToyStore" "Occupation" "Invoice" "AudioObject" "Demand" "FollowAction" "Residence" "AlignmentObject" "CategoryCodeSet" "Painting" "MonetaryAmountDistribution" "OfferForLease" "TireShop" "PublicToilet" "CategoryCode" "MedicalAudienceType" "Ticket" "Joint" "MedicalBusiness" "DefenceEstablishment" "LegislationObject" "ReturnLabelSourceEnumeration" "StatisticalVariable" "Accommodation" "ReviewNewsArticle" "ComicCoverArt" "ItemListOrderType" "PaintAction" "MoneyTransfer" "SoftwareApplication" "FinancialProduct" "RejectAction" "DiagnosticLab" "MedicalIntangible" "ShippingDeliveryTime" "BrainStructure" "Thing" "BodyOfWater" "AddAction" "MortgageLoan" "House" "DigitalPlatformEnumeration" "Project" "DepartmentStore" "EventVenue" "PreOrderAction" "MerchantReturnPolicySeasonalOverride" "CDCPMDRecord" "MusicVideoObject" "LiteraryEvent" "DrugClass" "InformAction" "NutritionInformation" "SubscribeAction" "PetStore" "Muscle" "RealEstateAgent" "GenderType" "BusinessEvent" "DeliveryTimeSettings" "UserLikes" "Newspaper" "MenuItem" "LandmarksOrHistoricalBuildings" "HowToSupply" "Certification" "SportsActivityLocation" "Distance" "Museum" "ChooseAction" "WearableMeasurementTypeEnumeration" "Recommendation" "PalliativeProcedure" "ArchiveOrganization" "MedicalProcedureType" "Courthouse" "Permit" "PaymentService" "MeasurementMethodEnum" "BorrowAction" "BuddhistTemple" "HairSalon" "CityHall" "ConsumeAction" "ClaimReview" "IndividualPhysician" "Comment" "Season" "MeetingRoom" "HowToTip" "Distillery" "Campground" "MensClothingStore" "MusicAlbum" "VideoGameClip" "MusicAlbumProductionType" "MovieClip" "GameAvailabilityEnumeration" "NewsMediaOrganization" "EmployeeRole" "MedicalSymptom" "BackgroundNewsArticle" "AccountingService" "TakeAction" "AutomatedTeller" "RestrictedDiet" "StadiumOrArena" "Blog" "ScheduleAction" "SuperficialAnatomy" "ReservationPackage" "WorkersUnion" "EntryPoint" "WearableSizeSystemEnumeration" "IPTCDigitalSourceEnumeration" "PlayGameAction" "GardenStore" "TrainTrip" "MedicalDevicePurpose" "Pond" "MolecularEntity" "ImageObject" "CompoundPriceSpecification" "FlightReservation" "OfficeEquipmentStore" "VoteAction" "MiddleSchool" "ApplyAction" "EducationEvent" "Article" "Energy" "MedicalContraindication" "RsvpAction" "SendAction" "InsertAction" "AutoRepair" "OnlineStore" "DatedMoneySpecification" "Vein" "BookStore" "OpinionNewsArticle" "ConstraintNode" "Researcher" "BoatReservation" "AdultOrientedEnumeration" "UserPlusOnes" "HealthClub" "RadioEpisode" "PlayAction" "Mosque" "WebAPI" "Enumeration" "BreadcrumbList" "Duration" "Quantity" "BusinessAudience" "ParkingFacility" "TVEpisode" "MediaManipulationRatingEnumeration" "LeaveAction" "ItemList" "TouristInformationCenter" "ExchangeRateSpecification" "OwnershipInfo" "TelevisionStation" "MapCategoryType" "ViewAction" "TVSeries" "Code" "HowTo" "HyperTocEntry" "Diet" "SingleFamilyResidence" "Store" "PostOffice" "UseAction" "Map" "Suite" "OrderAction" "MeasurementTypeEnumeration" "SearchRescueOrganization" "AutoWash" "ApprovedIndication" "OnlineBusiness" "CoverArt" "HobbyShop" "PronounceableText" "PreventionIndication" "UserPageVisits" "ReservationStatusType" "GeospatialGeometry" "CreativeWork" "FoodEstablishmentReservation" "RentalCarReservation" "WinAction" "Bakery" "PhysicalTherapy" "ClothingStore" "WantAction" "ControlAction" "CheckAction" "Country" "MusicReleaseFormatType" "Hackathon" "SizeSpecification" "CourseInstance" "MedicalCondition" "State" "IndividualProduct" "SizeSystemEnumeration" "Crematorium"

MMD_FILES	= $(CLASSES:"%"=mermaid-outputs/%.mmd)
SVG_FILES	= $(CLASSES:"%"=mermaid-outputs/%.svg)

# Excluding "3DModel" from the above list as it gives the following error:
#
# Error: Parse error on line 2:
# erDiagram3DModel {    string
# ---------^
# Expecting 'EOF', 'SPACE', 'NEWLINE', 'title', 'acc_title', 'acc_descr', 'acc_descr_multiline_value', 'ALPHANUM', 'ENTITY_NAME', got '3'
# Parser3.parseError (/home/mermaidcli/node_modules/mermaid/dist/mermaid.js:56538:28)
#     at #evaluate (file:///home/mermaidcli/node_modules/puppeteer-core/lib/esm/puppeteer/cdp/ExecutionContext.js:388:19)
#     at async ExecutionContext.evaluate (file:///home/mermaidcli/node_modules/puppeteer-core/lib/esm/puppeteer/cdp/ExecutionContext.js:275:16)
#     at async IsolatedWorld.evaluate (file:///home/mermaidcli/node_modules/puppeteer-core/lib/esm/puppeteer/cdp/IsolatedWorld.js:97:16)
#     at async CdpJSHandle.evaluate (file:///home/mermaidcli/node_modules/puppeteer-core/lib/esm/puppeteer/api/JSHandle.js:146:20)
#     at async CdpElementHandle.evaluate (file:///home/mermaidcli/node_modules/puppeteer-core/lib/esm/puppeteer/api/ElementHandle.js:340:20)
#     at async CdpElementHandle.$eval (file:///home/mermaidcli/node_modules/puppeteer-core/lib/esm/puppeteer/api/ElementHandle.js:494:24)
#     at async CdpFrame.$eval (file:///home/mermaidcli/node_modules/puppeteer-core/lib/esm/puppeteer/api/Frame.js:450:20)
#     at async CdpPage.$eval (file:///home/mermaidcli/node_modules/puppeteer-core/lib/esm/puppeteer/api/Page.js:450:20)
#     at async renderMermaid (file:///home/mermaidcli/node_modules/@mermaid-js/mermaid-cli/src/index.js:254:22)
#     at fromText (/home/mermaidcli/node_modules/mermaid/dist/mermaid.js:146633:21)


validate:
	linkml lint --validate --ignore-warnings schema.org.yaml

docker-pull:
	docker pull minlag/mermaid-cli:latest

mermaid-outputs:
	mkdir -p mermaid-outputs

init: docker-pull mermaid-outputs

$(MMD_FILES):
	@echo "Generating mermaid for $(@:mermaid-outputs/%=%)"; 
	linkml generate erdiagram --format mermaid -c "$(@:mermaid-outputs/%.mmd=%)" --max-hops 0 schema.org.yaml > "$@";

mermaid: $(MMD_FILES)

%.svg: %.mmd
	@echo "Generating SVG for $<"
	docker run --rm -v "$(WORKING_DIR)":/work -w /work -u root minlag/mermaid-cli --input "$<" --output "$@" --configFile mermaid.conf.json
	@sudo chown "$$USER" "$@"

svg: $(SVG_FILES)

clean:
	rm -rf mermaid-outputs

.DEFAULT_GOAL := svg